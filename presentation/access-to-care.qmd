---
title: "Access to Care"
subtitle: "Quarto presentation"
author: "Posit PBC"
format:
  revealjs:
    theme: [simple, theme.scss]
    slide-number: true
    transition: fade
    background-transition: fade
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.width = 9, fig.height = 7, fig.align = "center")
library(accesstocare)
```

## Data Sources

This analysis combines data from two authoritative sources:

- **Centers for Medicare & Medicaid Services (2025)**: Hospital location and facility information from the Medicare Provider Data
- **U.S. Census Bureau (2024)**: Population estimates at the county level

Together, these datasets allow us to examine the relationship between population distribution and hospital access across the United States.

## County Population vs Hospitals

Each point represents a county, showing population size and number of hospitals.

```{r}
atc_plot_hospitals()
```

## Statistical Model

Linear regression model predicting expected hospitals based on county population.

```{r}
summary(us_atc_model)
```

## Model Predictions

Pink region: fewer hospitals than expected. Blue region: more hospitals than expected.

```{r}
atc_plot_hospitals(show_model_results = TRUE)
```

## Underserved Counties by State

This map shows which states have the most counties with fewer hospitals than predicted by the model. Darker shades indicate more underserved counties.

```{r}
atc_plot_us_map(variable = "below")
```

## Most Underserved Counties

Counties with the largest gap between actual and expected hospital counts, based on population.

```{r}
library(gt)
library(dplyr)

us_counties |>
  filter(pred_status == "below") |>
  mutate(gap = pred_lwr - hospitals) |>
  arrange(desc(gap)) |>
  head(15) |>
  mutate(rank = row_number()) |>
  select(rank, county_name, state, population, hospitals, pred_lwr, pred_fit) |>
  gt() |>
  cols_label(
    rank = "#",
    county_name = "County",
    state = "State",
    population = "Population",
    hospitals = "Actual Hospitals",
    pred_lwr = "Minimum Expected",
    pred_fit = "Expected Hospitals"
  ) |>
  fmt_number(
    columns = c(population),
    decimals = 0
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) |>
  tab_options(
    table.font.size = px(20),
    heading.align = "left"
  )
```
